---
description: "Стандарты разработки API и TypeScript"
globs: ["**/api/**/*", "**/pages/api/**/*", "**/*.api.*", "**/*.ts", "**/*.tsx"]
alwaysApply: true
---

# Стандарты TypeScript и API

### Основные Принципы TypeScript

- Использовать английский язык для кода и документации
- Всегда объявлять типы для переменных и функций
  - Избегать использования any
  - Создавать необходимые типы
- Использовать JSDoc для документации публичных классов и методов
- Не оставлять пустых строк внутри функций
- Один экспорт на файл

### Именование

- Использовать PascalCase для классов
- Использовать camelCase для переменных, функций и методов
- Использовать kebab-case для файлов и директорий
- Использовать UPPERCASE для переменных окружения
  - Избегать магических чисел и определять константы
- Начинать каждую функцию с глагола
- Использовать глаголы для булевых переменных (isLoading, hasError)
- Использовать полные слова вместо сокращений
  - Кроме стандартных сокращений (API, URL)
  - Кроме общепринятых сокращений:
    - i, j для циклов
    - err для ошибок
    - ctx для контекстов
    - req, res, next для параметров middleware

### Функции

- Писать короткие функции с единственной целью (менее 20 инструкций)
- Именовать функции с глаголом
  - Для булевых возвратов использовать isX, hasX, canX
  - Для void функций использовать executeX, saveX
- Избегать вложенных блоков через:
  - Ранние проверки и возвраты
  - Выделение в утилитарные функции
- Использовать функции высшего порядка (map, filter, reduce)
- Использовать параметры по умолчанию
- Использовать объекты для множественных параметров
- Придерживаться одного уровня абстракции

### Данные

- Не злоупотреблять примитивными типами
- Избегать валидации в функциях, использовать классы
- Предпочитать иммутабельность
  - Использовать readonly для неизменяемых данных
  - Использовать as const для литералов

### REST API Стандарты

- Использовать правильные HTTP методы
- Реализовывать правильную обработку ошибок
- Использовать правильные статус коды
- Форматировать ответы в JSON
- Валидировать входные данные
- Реализовывать правильное кэширование
- Использовать правильные заголовки
- Реализовывать правильную аутентификацию
- Документировать все эндпоинты

### Безопасность

- Использовать HTTPS
- Реализовывать аутентификацию
- Внедрять авторизацию
- Защищать от CSRF
- Использовать rate limiting
- Валидировать входные данные
- Санитизировать выходные данные

### Тестирование

- Следовать конвенции Arrange-Act-Assert
- Четко именовать тестовые переменные
- Писать unit тесты для публичных функций
- Писать интеграционные тесты
- Использовать моки для зависимостей
- Следовать конвенции Given-When-Then

### Архитектура

- Использовать модульную архитектуру
- Разделять на слои:
  - Контроллеры
  - Сервисы
  - Репозитории
  - Модели
- Использовать DI
- Реализовывать обработку ошибок
- Использовать middleware
- Реализовывать логирование